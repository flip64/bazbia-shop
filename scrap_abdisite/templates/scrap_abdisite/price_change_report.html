{% extends 'scrap_abdisite/base.html' %}
{% load humanize %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-3">ğŸ“ˆ Ú¯Ø²Ø§Ø±Ø´ ØªØºÛŒÛŒØ±Ø§Øª Ù‚ÛŒÙ…Øª (ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ)</h2>

  <form method="get" class="row g-3 mb-4">
    <div class="col-md-3">
      <label>Ø§Ø² ØªØ§Ø±ÛŒØ®:</label>
      <input id="start" name="start" class="form-control" value="{{ j_start }}" autocomplete="off" />
    </div>
    <div class="col-md-3">
      <label>ØªØ§ ØªØ§Ø±ÛŒØ®:</label>
      <input id="end" name="end" class="form-control" value="{{ j_end }}" autocomplete="off" />
    </div>
    <div class="col-md-4 align-self-end">
      <div class="btn-group w-100">
        <button name="range" value="week" class="btn btn-outline-primary {% if range_option == 'week' %}active{% endif %}">Ù‡ÙØªÙ‡ Ø§Ø®ÛŒØ±</button>
        <button name="range" value="month" class="btn btn-outline-primary {% if range_option == 'month' %}active{% endif %}">Ù…Ø§Ù‡ Ø§Ø®ÛŒØ±</button>
        <button name="range" value="year" class="btn btn-outline-primary {% if range_option == 'year' %}active{% endif %}">Ø³Ø§Ù„ Ø§Ø®ÛŒØ±</button>
      </div>
    </div>
    <div class="col-md-2 align-self-end">
      <button class="btn btn-primary w-100">Ù†Ù…Ø§ÛŒØ´</button>
    </div>
  </form>

  {% if report_data %}
  <table class="table table-striped table-bordered text-center align-middle">
    <thead>
      <tr>
        <th>Ù…Ø­ØµÙˆÙ„</th>
        <th>ØªØ£Ù…ÛŒÙ†â€ŒÚ©Ù†Ù†Ø¯Ù‡</th>
        <th>Ù‚ÛŒÙ…Øª Ù‚Ø¨Ù„ÛŒ</th>
        <th>Ù‚ÛŒÙ…Øª Ø¬Ø¯ÛŒØ¯</th>
        <th>ØªØºÛŒÛŒØ±</th>
        <th>Ø¯Ø±ØµØ¯ ØªØºÛŒÛŒØ±</th>
        <th>Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±Ø±Ø³ÛŒ (Ø´Ù…Ø³ÛŒ)</th>
      </tr>
    </thead>
    <tbody>
      {% for item in report_data %}
      <tr>
        <td>{{ item.product }}</td>
        <td>{{ item.supplier }}</td>
        <td>{{ item.old_price|intcomma }} ØªÙˆÙ…Ø§Ù†</td>
        <td>{{ item.new_price|intcomma }} ØªÙˆÙ…Ø§Ù†</td>
        <td>
          {% if item.change > 0 %}
            <span class="text-success">+{{ item.change|intcomma }}</span>
          {% elif item.change < 0 %}
            <span class="text-danger">{{ item.change|intcomma }}</span>
          {% else %}
            Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±
          {% endif %}
        </td>
        <td>{{ item.percent }}Ùª</td>
        <td>{{ item.last_checked }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="mt-3 text-muted">Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø§Ø²Ù‡ Ù‡ÛŒÚ† Ù…Ø­ØµÙˆÙ„ÛŒ ØªØºÛŒÛŒØ± Ù‚ÛŒÙ…Øª Ù†Ø¯Ø§Ø´ØªÙ‡ Ø§Ø³Øª.</p>
  {% endif %}
</div>

<!-- ğŸ“… Persian Date Picker -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css" />
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-date/dist/persian-date.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-datepicker/dist/js/persian-datepicker.min.js"></script>
<script>
  $(function(){
    $("#start").persianDatepicker({ format: "YYYY-MM-DD", initialValue: false });
    $("#end").persianDatepicker({ format: "YYYY-MM-DD", initialValue: false });
  });
</script>
{% endblock %}
